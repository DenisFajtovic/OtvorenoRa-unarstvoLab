SET client_encoding TO 'UTF8';
\copy (select array_to_json(array_agg(row_to_json(t))) from ( select b."Id", json_build_object( 'Ime', f."Ime", 'Prezime', f."Prezime" ) as Fotograf, json_build_object( 'Ime', m."Ime", 'Prezime', m."Prezime" ) as Mladenac, json_build_object( 'Ime', a."Ime", 'Prezime', a."Prezime" ) as Mladenka, b."Format", b."Korice", b."Broj listova", b."Paket", b."Faceoff", b."Cijena" from "Book" b inner join "Osobe" f on b."Fotograf" = f."OIB" inner join "Osobe" m on b."Mladenac" = m."OIB" inner join "Osobe" a on b."Mladenka" = a."OIB" ) t) to data.json
\copy (select b."Id", f."Ime" as FotografIme, f."Prezime" FotografPrezime, m."Ime" as MladenacIme, m."Prezime" as MladenacPrezime, a."Ime" as MladenkaIme, a."Prezime" as MladenkaPrezime, b."Format", b."Korice", b."Broj listova", b."Paket", b."Faceoff", b."Cijena" from "Book" b inner join "Osobe" f on b."Fotograf" = f."OIB" inner join "Osobe" m on b."Mladenac" = m."OIB" inner join "Osobe" a on b."Mladenka" = a."OIB") to 'data.csv' csv header
\q
